CmltcG9ydCBkaXNjb3JkCmZyb20gZGlzY29yZC5leHQgaW1wb3
J0IGNvbW1hbmRzIApmcm9tIGRpc2NvcmQudXRpbHMgaW1wb3J0
IGdldAppbXBvcnQgb3MKaW1wb3J0IGFzeW5jaW8KaW1wb3J0IH
JhbmRvbQppbXBvcnQgcmUKaW1wb3J0IGpzb24KaW1wb3J0IHN0
cmluZwpmcm9tIGRpc2NvcmQuZXh0LmNvbW1hbmRzIGltcG9ydC
BoYXNfcGVybWlzc2lvbnMsIE1pc3NpbmdQZXJtaXNzaW9ucwpm
cm9tIGRpc2NvcmQgaW1wb3J0IEZpbGUKaW1wb3J0IGlvCgpkZW
YgX19pbml0X18oc2VsZiwgY2xpZW50KToKICAgIHNlbGYuY2xp
ZW50ID0gY2xpZW50CgoKaW50ZW50cyA9IGRpc2NvcmQuSW50ZW
50cy5kZWZhdWx0KCkKaW50ZW50cy5tZW1iZXJzID0gVHJ1ZQoK
Y2xpZW50ID0gY29tbWFuZHMuQm90KGNvbW1hbmRfcHJlZml4PS
IuIiwgaW50ZW50cz1pbnRlbnRzLCBjYXNlX2luc2Vuc2l0aXZl
PVRydWUpCgojZ2xvYmFsIGJhbm5pbmcgYm90IHRlc3QKCkBjbG
llbnQuZXZlbnQgCmFzeW5jIGRlZiBvbl9tZW1iZXJfam9pbiht
ZW1iZXIpOgogICAgYXdhaXQgbWVtYmVyLnNlbmQoZiJXZWxjb2
1lIFRvIHttZW1iZXIuZ3VpbGQubmFtZX0gRW5qb3kgWW91ciBT
dGF5IDopIikKCiAgICB3aXRoIG9wZW4oJ2Jhbmxpc3QuanNvbi
csICdyJykgYXMgZjoKICAgICAgICBsb2FkID0ganNvbi5sb2Fk
KGYpCiAgICB0cnk6CiAgICAgICAgbG9hZFtzdHIobWVtYmVyLm
lkKV0KICAgIGV4Y2VwdCBLZXlFcnJvcjoKICAgICAgICByZXR1
cm4KCiAgICBhd2FpdCBtZW1iZXIuc2VuZChmIllvdSdyZSBnbG
9iYWxseSBiYW5uZWQuIikKICAgIGF3YWl0IG1lbWJlci5iYW4o
cmVhc29uPSJUaGlzIHVzZXIgd2FzIHByZXZpb3VzbHkgZ2xvYm
FsbHkgYmFubmVkLiIpCiAgICBkcm9wcHhsb2dzID0gY2xpZW50
LmdldF9jaGFubmVsKDg4NzEzOTY5NjQxNTczOTk3MCkKICAgIG
F3YWl0IGRyb3BweGxvZ3Muc2VuZChmIioqe21lbWJlcn0qKiB8
ICoqe21lbWJlci5pZH0qKiB3YXMgcmVtb3ZlZCBmcm9tIHttZW
1iZXIuZ3VpbGQubmFtZX0iKQoKCkBjbGllbnQuZXZlbnQKYXN5
bmMgZGVmIG9uX2d1aWxkX2pvaW4oZ3VpbGQpOgogICAgbmV3c2
VydmVyam9pbmxvZyA9IGNsaWVudC5nZXRfY2hhbm5lbCg4ODcx
Mzk2OTY3MDA5NTY3MjIpCiAgICBhd2FpdCBuZXdzZXJ2ZXJqb2
lubG9nLnNlbmQoZiJEcm9wcHggSGFzIEJlZW4gQWRkZWQgVG8g
QSBOZXcgU2VydmVyISBTZXJ2ZXIncyBOYW1lOiAqKntndWlsZC
5uYW1lfSoqIFdpdGggVGhlIEd1aWxkIElEOiAqKntndWlsZC5p
ZH0qKiBTZXJ2ZXIgT3duZXI6ICoqe2d1aWxkLm93bmVyfSoqIi
kKCgojTW9kZXJhdGlvbiBDb21tYW5kczoKCkBjbGllbnQuZXZl
bnQKYXN5bmMgZGVmIG9uX3JlYWR5KCk6CiAgICBvbmxpbmUgPS
BUcnVlCiAgICB3aGlsZSBvbmxpbmU6CgogICAgIGF3YWl0IGNs
aWVudC5jaGFuZ2VfcHJlc2VuY2UoYWN0aXZpdHk9ZGlzY29yZC
5BY3Rpdml0eSh0eXBlPWRpc2NvcmQuQWN0aXZpdHlUeXBlLmxp
c3RlbmluZywgbmFtZT1mIkBEcm9wcFggQm90IHwgTW9kZXJhdG
lvbi9HbG9iYWwgQmFubmluZyBCb3QuIFVzZXJzOiB7bGVuKGNs
aWVudC51c2Vycyl9IikpCiAgICBhd2FpdCBhc3luY2lvLnNsZW
VwKDcpCgogICAgcHJpbnQoIkJvdCBpcyBvbmxpbmUhIikKCgpA
Y2xpZW50LmNvbW1hbmQoKSAjQmFuIGNvbW1hbmQKQGNvbW1hbm
RzLmlzX293bmVyKCkKYXN5bmMgZGVmIG1hbnVhbGJhbihjdHgs
IG1lbWJlciA6IGRpc2NvcmQuVXNlciwgKiwgcmVhc29uPU5vbm
UpOgoKICAgIG93bmVyX2lkcyA9IFs4NDI2MjYzNTI5NTA2NzM0
MTgsIDcwMDg3MTU4NzEyMDkzOTAxOF0KICAgIGlmIG1lbWJlci
5pZCBpbiBvd25lcl9pZHM6CiAgICAgICAgcmV0dXJuIGF3YWl0
IGN0eC5zZW5kKCJZb3UgY2Fubm90IGRvIHRoaXMuIikKICAgIA
ogICAgbnVtYmVycyA9IHN0cmluZy5kaWdpdHMKICAgIGJhbl9p
ZCA9ICcnLmpvaW4ocmFuZG9tLnNhbXBsZShudW1iZXJzLCA1KS
kKICAgIAogICAgZHJvcHB4bG9ncyA9IGNsaWVudC5nZXRfY2hh
bm5lbCg4ODcxMzk2OTY0MTU3Mzk5NzApCiAgICBkcm9wcHhnbG
9iYWxiYW5zID0gY2xpZW50LmdldF9jaGFubmVsKDg4NzEzOTY5
NjQxNTczOTk3MSkKICAgIAogICAgYXdhaXQgZHJvcHB4bG9ncy
5zZW5kKGYiVXNlciB7bWVtYmVyLm5hbWV9IGhhcyBiZWVuIGds
b2JhbGx5IGJhbm5lZCBmb3IgdGhlIHJlYXNvbjoge3JlYXNvbn
0gd2l0aCB0aGUgYmFuIElEOiB7YmFuX2lkfSIpCiAgICBhd2Fp
dCBjdHgucmVwbHkoZiJVc2VyIHttZW1iZXIubmFtZX0gaGFzIG
JlZW4gZ2xvYmFsbHkgYmFubmVkIGZvciB0aGUgcmVhc29uOiB7
cmVhc29ufSB3aXRoIHRoZSBiYW4gSUQ6IHtiYW5faWR9IikKIC
AgIAogICAgd2l0aCBvcGVuKCdiYW5saXN0Lmpzb24nLCAncicp
IGFzIGY6CiAgICAgICAgbG9hZCA9IGpzb24ubG9hZChmKQogIC
AgICAgIAogICAgCiAgICBzZXJ2ZXJzX2Jhbm5lZF9mcm9tID0g
W10KICAgIAogICAgZm9yIGd1aWxkIGluIGNsaWVudC5ndWlsZH
M6CiAgICAgICAgaWYgbWVtYmVyIGluIGd1aWxkLm1lbWJlcnM6
CiAgICAgICAgICAgIGF3YWl0IGd1aWxkLmJhbih1c2VyPW1lbW
JlciwgcmVhc29uPXJlYXNvbikKICAgICAgICAgICAgc2VydmVy
c19iYW5uZWRfZnJvbS5hcHBlbmQoZ3VpbGQuaWQpCiAgICAgIC
AgICAgIGF3YWl0IGFzeW5jaW8uc2xlZXAoNCkKICAgICAgICBl
bHNlOgogICAgICAgICAgICBwYXNzCiAgICAgICAgCiAgICAgIC
Agd2l0aCBvcGVuKCdiYW5zLmpzb24nLCAncicpIGFzIGY6CiAg
ICAgICAgICAgIGIgPSBqc29uLmxvYWQoZikKICAgICAgICAgIC
AgCiAgICAgICAgYltzdHIoYmFuX2lkKV0gPSB7fQogICAgICAg
IGJbc3RyKGJhbl9pZCldWyJVc2VyIElEIl0gPSBpbnQobWVtYm
VyLmlkKQogICAgICAgIGJbc3RyKGJhbl9pZCldWyJSZWFzb24i
XSA9IHJlYXNvbgogICAgICAgIGJbc3RyKGJhbl9pZCldWyJTZX
J2ZXJzIl0gPSBzZXJ2ZXJzX2Jhbm5lZF9mcm9tCiAgICAgICAg
CiAgICAgICAgd2l0aCBvcGVuKCdiYW5zLmpzb24nLCAndycpIG
FzIGY6CiAgICAgICAgICAgIGpzb24uZHVtcChiLCBmLCBpbmRl
bnQ9NCkKICAgICAgICAgICAgCiAgICAgICAgbG9hZFtzdHIobW
VtYmVyLmlkKV0gPSBzdHIocmVhc29uKQogICAgICAgIAogICAg
ICAgIHdpdGggb3BlbignYmFubGlzdC5qc29uJywgJ3cnKSBhcy
BmOgogICAgICAgICAgICBqc29uLmR1bXAobG9hZCwgZiwgaW5k
ZW50PTQpCiAgICAgICAgICAgIAogICAgICAgIHdpdGggb3Blbi
gnYmFucy5qc29uJywgJ3InKSBhcyBmOgogICAgICAgICAgICBi
ID0ganNvbi5sb2FkKGYpCiAgICAgICAgICAgIAogICAgICAgIG
Jbc3RyKGJhbl9pZCldID0ge30KICAgICAgICBiW3N0cihiYW5f
aWQpXVsiVXNlciBJRCJdID0gaW50KG1lbWJlci5pZCkKICAgIC
AgICBiW3N0cihiYW5faWQpXVsiUmVhc29uIl0gPSByZWFzb24K
ICAgICAgICBiW3N0cihiYW5faWQpXVsiU2VydmVycyJdID0gc2
VydmVyc19iYW5uZWRfZnJvbQogICAgICAgIGJbc3RyKGJhbl9p
ZCldWyJTdGFmZiJdID0gaW50KGN0eC5hdXRob3IuaWQpCiAgIC
AgICAgCiAgICAgICAgd2l0aCBvcGVuKCdiYW5zLmpzb24nLCAn
dycpIGFzIGY6CiAgICAgICAgICAgIGpzb24uZHVtcChiLCBmLC
BpbmRlbnQ9NCkKICAgICAgICAKCkBjbGllbnQuY29tbWFuZCgp
ICNCYW4gY29tbWFuZApAY29tbWFuZHMuaXNfb3duZXIoKQphc3
luYyBkZWYgZ2xvYmFsYmFuKGN0eCwgbWVtYmVyIDogZGlzY29y
ZC5Vc2VyLCAqLCByZWFzb249Tm9uZSk6CgogICAgb3duZXJfaW
RzID0gWzg0MjYyNjM1Mjk1MDY3MzQxOCwgNzAwODcxNTg3MTIw
OTM5MDE4XQogICAgaWYgbWVtYmVyLmlkIGluIG93bmVyX2lkcz
oKICAgICAgICByZXR1cm4gYXdhaXQgY3R4LnNlbmQoIllvdSBj
YW5ub3QgZG8gdGhpcy4iKQogICAgCiAgICBudW1iZXJzID0gc3
RyaW5nLmRpZ2l0cwogICAgYmFuX2lkID0gJycuam9pbihyYW5k
b20uc2FtcGxlKG51bWJlcnMsIDUpKQogICAgCiAgICBkcm9wcH
hsb2dzID0gY2xpZW50LmdldF9jaGFubmVsKDg4NzEzOTY5NjQx
NTczOTk3MCkKICAgIGRyb3BweGdsb2JhbGJhbnMgPSBjbGllbn
QuZ2V0X2NoYW5uZWwoODg3MTM5Njk2NDE1NzM5OTcxKQogICAg
CiAgICBhd2FpdCBkcm9wcHhsb2dzLnNlbmQoZiJVc2VyIHttZW
1iZXIubmFtZX0gaGFzIGJlZW4gZ2xvYmFsbHkgYmFubmVkIGZv
ciB0aGUgcmVhc29uOiB7cmVhc29ufSB3aXRoIHRoZSBiYW4gSU
Q6IHtiYW5faWR9IikKICAgIGF3YWl0IGN0eC5yZXBseShmIlVz
ZXIge21lbWJlci5uYW1lfSBoYXMgYmVlbiBnbG9iYWxseSBiYW
5uZWQgZm9yIHRoZSByZWFzb246IHtyZWFzb259IHdpdGggdGhl
IGJhbiBJRDoge2Jhbl9pZH0iKQogICAgYXdhaXQgbWVtYmVyLn
NlbmQoZiJZb3UgaGF2ZSBiZWVuIGJhbm5lZCBmcm9tIHtjdHgu
Z3VpbGQubmFtZX0gZm9yIHRoZSByZWFzb246IHtyZWFzb259IG
J5IHtjdHguYXV0aG9yfSIpCiAgICAKICAgIHdpdGggb3Blbign
YmFubGlzdC5qc29uJywgJ3InKSBhcyBmOgogICAgICAgIGxvYW
QgPSBqc29uLmxvYWQoZikKICAgICAgICAKICAgIAogICAgc2Vy
dmVyc19iYW5uZWRfZnJvbSA9IFtdCiAgICAKICAgIGZvciBndW
lsZCBpbiBjbGllbnQuZ3VpbGRzOgogICAgICAgIGlmIG1lbWJl
ciBpbiBndWlsZC5tZW1iZXJzOgogICAgICAgICAgICBhd2FpdC
BndWlsZC5iYW4odXNlcj1tZW1iZXIsIHJlYXNvbj1yZWFzb24p
CiAgICAgICAgICAgIHNlcnZlcnNfYmFubmVkX2Zyb20uYXBwZW
5kKGd1aWxkLmlkKQogICAgICAgICAgICBhd2FpdCBhc3luY2lv
LnNsZWVwKDQpCiAgICAgICAgZWxzZToKICAgICAgICAgICAgcG
FzcwogICAgICAgIAogICAgICAgIAogICAgICAgIHdpdGggb3Bl
bignYmFucy5qc29uJywgJ3InKSBhcyBmOgogICAgICAgICAgIC
BiID0ganNvbi5sb2FkKGYpCiAgICAgICAgICAgIAogICAgICAg
IGJbc3RyKGJhbl9pZCldID0ge30KICAgICAgICBiW3N0cihiYW
5faWQpXVsiVXNlciBJRCJdID0gaW50KG1lbWJlci5pZCkKICAg
ICAgICBiW3N0cihiYW5faWQpXVsiUmVhc29uIl0gPSByZWFzb2
4KICAgICAgICBiW3N0cihiYW5faWQpXVsiU2VydmVycyJdID0g
c2VydmVyc19iYW5uZWRfZnJvbQogICAgICAgIAogICAgICAgIH
dpdGggb3BlbignYmFucy5qc29uJywgJ3cnKSBhcyBmOgogICAg
ICAgICAgICBqc29uLmR1bXAoYiwgZiwgaW5kZW50PTQpCiAgIC
AgICAgICAgIAogICAgICAgIGxvYWRbc3RyKG1lbWJlci5pZCld
ID0gc3RyKHJlYXNvbikKICAgICAgICAKICAgICAgICB3aXRoIG
9wZW4oJ2Jhbmxpc3QuanNvbicsICd3JykgYXMgZjoKICAgICAg
ICAgICAganNvbi5kdW1wKGxvYWQsIGYsIGluZGVudD00KQogIC
AgICAgICAgICAKICAgICAgICB3aXRoIG9wZW4oJ2JhbnMuanNv
bicsICdyJykgYXMgZjoKICAgICAgICAgICAgYiA9IGpzb24ubG
9hZChmKQogICAgICAgICAgICAKICAgICAgICBiW3N0cihiYW5f
aWQpXSA9IHt9CiAgICAgICAgYltzdHIoYmFuX2lkKV1bIlVzZX
IgSUQiXSA9IGludChtZW1iZXIuaWQpCiAgICAgICAgYltzdHIo
YmFuX2lkKV1bIlJlYXNvbiJdID0gcmVhc29uCiAgICAgICAgYl
tzdHIoYmFuX2lkKV1bIlNlcnZlcnMiXSA9IHNlcnZlcnNfYmFu
bmVkX2Zyb20KICAgICAgICBiW3N0cihiYW5faWQpXVsiU3RhZm
YiXSA9IGludChjdHguYXV0aG9yLmlkKQogICAgICAgIAogICAg
ICAgIHdpdGggb3BlbignYmFucy5qc29uJywgJ3cnKSBhcyBmOg
ogICAgICAgICAgICBqc29uLmR1bXAoYiwgZiwgaW5kZW50PTQp
CgoKQGNsaWVudC5jb21tYW5kKCkKQGNvbW1hbmRzLmlzX293bm
VyKCkKYXN5bmMgZGVmIHNlYXJjaGJhbihjdHgsIGJhbl9pZDog
aW50KToKICAgIHdpdGggb3BlbignYmFucy5qc29uJywgJ3InKS
BhcyBmOgogICAgICAgIGxvYWQgPSBqc29uLmxvYWQoZikKCiAg
ICB0cnk6CiAgICAgICAgbG9hZFtzdHIoYmFuX2lkKV0KICAgIG
V4Y2VwdCBLZXlFcnJvcjoKICAgICAgICByZXR1cm4gYXdhaXQg
Y3R4LnNlbmQoZiJDYW5ub3QgZmluZCByZWNvcmRzIG9mIGJhbj
oge2Jhbl9pZH0iKQoKICAgIAogICAgCiAgICByZWFzb24gPSBs
b2FkW3N0cihiYW5faWQpXVsiUmVhc29uIl0KICAgIHN0YWZmX2
lkID0gbG9hZFtzdHIoYmFuX2lkKV1bIlN0YWZmIl0KICAgIHVz
ZXJfaWQgPSBsb2FkW3N0cihiYW5faWQpXVsiVXNlciBJRCJdCi
AgICB1c2VyID0gY2xpZW50LmdldF91c2VyKHVzZXJfaWQpCiAg
ICBzdGFmZiA9IGNsaWVudC5nZXRfdXNlcihzdGFmZl9pZCkKIC
AgIAogICAgZW1iZWQgPSBkaXNjb3JkLkVtYmVkKAogICAgICAg
IGNvbG9yPWN0eC5hdXRob3IuY29sb3IsIGRlc2NyaXB0aW9uPW
YiQmFuIGluZm9ybWF0aW9uIGZvciB7YmFuX2lkfSIpCiAgICBl
bWJlZC5hZGRfZmllbGQobmFtZT0iVXNlciIsIHZhbHVlPWYie3
VzZXJfaWR9IiwgaW5saW5lPUZhbHNlKQogICAgZW1iZWQuYWRk
X2ZpZWxkKG5hbWU9IlJlYXNvbiIsIHZhbHVlPXJlYXNvbiwgaW
5saW5lPUZhbHNlKQogICAgZW1iZWQuYWRkX2ZpZWxkKG5hbWU9
IlN0YWZmIiwgdmFsdWU9ZiJ7c3RhZmZ9ICh7c3RhZmYuaWR9KS
IsIGlubGluZT1GYWxzZSkKICAgIAogICAgYXdhaXQgY3R4LnNl
bmQoZW1iZWQ9ZW1iZWQpCgoKICAgICAgICAgICAgCiAgICAgIC
AgCkBjbGllbnQuY29tbWFuZCgpICNCYW4gY29tbWFuZApAaGFz
X3Blcm1pc3Npb25zKGJhbl9tZW1iZXJzPVRydWUsIGtpY2tfbW
VtYmVycz1UcnVlKQphc3luYyBkZWYgYmFuKGN0eCwgbWVtYmVy
IDogZGlzY29yZC5NZW1iZXIsICosIHJlYXNvbj1Ob25lKToKIC
AgIHN0YWZmX2lkcyA9IFs4NDI2MjYzNTI5NTA2NzM0MTgsIDcw
MDg3MTU4NzEyMDkzOTAxOF0KICAgIGlmIG1lbWJlci5pZCBpbi
BzdGFmZl9pZHM6CiAgICAgICAgcmV0dXJuIGF3YWl0IGN0eC5z
ZW5kKCJZb3UgY2Fubm90IGRvIHRoaXMuIFlvdSdyZSB0cnlpbm
cgdG8gYmFuIGEgc3RhZmYgbWVtYmVyLiIpCiAgICBkcm9wcHhs
b2dzID0gY2xpZW50LmdldF9jaGFubmVsKDg4NzEzOTY5NjQxNT
czOTk3MCkKCiAgICBlbWJlZCA9IGRpc2NvcmQuRW1iZWQoCiAg
ICBjb2xvcj1jdHguYXV0aG9yLmNvbG9yLCBkZXNjcmlwdGlvbj
0iTWVzc2FnZSBGcm9tIERST1BQWCIpCiAgICBlbWJlZC5hZGRf
ZmllbGQobmFtZT1mIkJhbm5lZCB7bWVtYmVyfSIsIHZhbHVlPW
YiWW91IEhhdmUgQmVlbiBCYW5uZWQgRnJvbSB7Y3R4Lmd1aWxk
Lm5hbWV9IEZvcjoge3JlYXNvbn0iLCBpbmxpbmU9RmFsc2UpCi
AgICBlbWJlZC5zZXRfYXV0aG9yKG5hbWU9Y3R4LmF1dGhvciwg
aWNvbl91cmw9Y3R4LmF1dGhvci5hdmF0YXJfdXJsKQogICAgZW
1iZWQuc2V0X3RodW1ibmFpbCh1cmw9Y3R4Lmd1aWxkLmljb25f
dXJsKQogICAgYXdhaXQgY3R4LnNlbmQoZW1iZWQ9ZW1iZWQpCi
AgICBhd2FpdCBtZW1iZXIuc2VuZChlbWJlZD1lbWJlZCkKICAg
IGF3YWl0IG1lbWJlci5iYW4ocmVhc29uPXJlYXNvbikKICAgIG
F3YWl0IGRyb3BweGxvZ3Muc2VuZChmInttZW1iZXIubmFtZX0g
fCB7bWVtYmVyLmlkfSBoYXMgYmVlbiBiYW5uZWQgYnkgKip7Y3
R4LmF1dGhvcn0qKiBmb3IgYHtyZWFzb259YCIpCgpAY2xpZW50
LmNvbW1hbmQoKQphc3luYyBkZWYgcmVwb3J0dXNlcihjdHgsIG
1lbWJlciA6IGRpc2NvcmQuVXNlciwgKiwgcmVhc29uPU5vbmUp
OgogICAgZHJvcHB4bG9ncyA9IGNsaWVudC5nZXRfY2hhbm5lbC
g4ODcxMzk2OTY0MTU3Mzk5NzIpCiAgICAKICAgIG93bmVyX2lk
cyA9IFs4NDI2MjYzNTI5NTA2NzM0MTgsIDcwMDg3MTU4NzEyMD
kzOTAxOF0KICAgIGlmIG1lbWJlci5pZCBpbiBvd25lcl9pZHM6
CiAgICAgICAgcmV0dXJuIGF3YWl0IGN0eC5zZW5kKCJZb3UgY2
Fubm90IHJlcG9ydCBvd25lcidzIG9mIHRoZSBib3QuIikKCiAg
ICBhd2FpdCBjdHguYXV0aG9yLnNlbmQoZiJZb3UgSGF2ZSBTdW
NjZXNmdWxseSBSZXBvcnRlZCB7bWVtYmVyLm5hbWV9IHwge21l
bWJlci5pZH0gUGx6IFdhaXQgVXAgVG8gMjQgSG91cnMgVG8gR2
V0IEEgUmVzcG9uc2UgRnJvbSBUaGUgU3RhZmYgVGVhbSBPZiBE
cm9wcHguIikKICAgIGF3YWl0IGRyb3BweGxvZ3Muc2VuZChmIn
ttZW1iZXIubmFtZX0gfCB7bWVtYmVyLmlkfSBoYXMgYmVlbiBy
ZXBvcnRlZCBieSAqKntjdHguYXV0aG9yfSoqIGZvciBge3JlYX
Nvbn1gIFRoaXMgUmVwb3J0IEhhcyBDb21lIEZyb20gVGhlIFNl
cnZlciBge2N0eC5ndWlsZC5uYW1lfWAgV2l0aCBUaGUgR3VpbG
QgSUQ6IGB7Y3R4Lmd1aWxkLmlkfWAiKQogICAgYXdhaXQgY3R4
Lm1lc3NhZ2UuZGVsZXRlKCkKCgpAY2xpZW50LmNvbW1hbmQoKQ
phc3luYyBkZWYgc3VnZ2VzdChjdHgsICosIFN1Z2dlc3Rpb249
Tm9uZSk6CiAgICBkcm9wcHhsb2dzID0gY2xpZW50LmdldF9jaG
FubmVsKDg4NzEzOTY5NjQxNTczOTk3MykKCiAgICBhd2FpdCBj
dHguYXV0aG9yLnNlbmQoZiJUaGFuayBZb3UgRm9yIFRoZSBTdW
dnZXN0aW9uIFdlIFdpbGwgQ2hlY2sgSXQgT3V0ISIpCiAgICBh
d2FpdCBkcm9wcHhsb2dzLnNlbmQoZiIqKntjdHguYXV0aG9yfS
oqIEhhcyBNYWRlIEEgU3VnZ2VzdGlvbiBUaGV5IFN1Z2dlc3Q6
IHtTdWdnZXN0aW9ufSIpCiAgICBhd2FpdCBjdHgubWVzc2FnZS
5kZWxldGUoKQoKQGNsaWVudC5jb21tYW5kKCkKQGNvbW1hbmRz
LmlzX293bmVyKCkKYXN5bmMgZGVmIGFubm91bmNlKGN0eCwgVG
l0bGVvZmVtYmVkPU5vbmUsICosIGFubm91bmNlbWVudD1Ob25l
KToKICAgIGFubm91bmNlY2hhbm5lbCA9IGNsaWVudC5nZXRfY2
hhbm5lbCg4NzIzNTk4NDAzMTQ0NDE3OTIpCgogICAgZW1iZWQg
PSBkaXNjb3JkLkVtYmVkKAogICAgY29sb3I9Y3R4LmF1dGhvci
5jb2xvciwgZGVzY3JpcHRpb249ZiJ7VGl0bGVvZmVtYmVkfSIp
CiAgICBlbWJlZC5hZGRfZmllbGQobmFtZT0iRHJvcHBYIiwgdm
FsdWU9ZiJBbm5vdW5jZW1lbnQhIiwgaW5saW5lPUZhbHNlKQog
ICAgZW1iZWQuYWRkX2ZpZWxkKG5hbWU9IkFubm91bmNlbWVudC
IsIHZhbHVlPWYiTmV3IEFubm91bmNlbWVudDoge2Fubm91bmNl
bWVudH1cbiIsIGlubGluZT1GYWxzZSkKICAgIGVtYmVkLnNldF
9mb290ZXIodGV4dD1mIlRoaXMgQW5ub3VuY2VtZW50IEhhcyBC
ZWVuIFNlbnQgQnkge2N0eC5hdXRob3IubmFtZX0iKQogICAgZW
1iZWQuc2V0X2F1dGhvcihuYW1lPWN0eC5hdXRob3IsIGljb25f
dXJsPWN0eC5hdXRob3IuYXZhdGFyX3VybCkKICAgIGVtYmVkLn
NldF90aHVtYm5haWwodXJsPWN0eC5ndWlsZC5pY29uX3VybCkK
ICAgIGF3YWl0IGFubm91bmNlY2hhbm5lbC5zZW5kKGVtYmVkPW
VtYmVkKQogICAgCiAgICBhd2FpdCBhbm5vdW5jZWNoYW5uZWwu
c2VuZCgiQGV2ZXJ5b25lIikKCgpAY2xpZW50LmNvbW1hbmQoKS
AjS2ljayBjb21tYW5kCkBoYXNfcGVybWlzc2lvbnMoa2lja19t
ZW1iZXJzPVRydWUpCmFzeW5jIGRlZiBraWNrKGN0eCwgbWVtYm
VyIDogZGlzY29yZC5NZW1iZXIsICosIHJlYXNvbj1Ob25lKToK
ICAgIHN0YWZmX2lkcyA9IFs4NDI2MjYzNTI5NTA2NzM0MTgsID
cwMDg3MTU4NzEyMDkzOTAxOF0KICAgIGlmIG1lbWJlci5pZCBp
biBzdGFmZl9pZHM6CiAgICAgICAgcmV0dXJuIGF3YWl0IGN0eC
5zZW5kKCJZb3UgY2Fubm90IGRvIHRoaXMuIFlvdSdyZSB0cnlp
bmcgdG8ga2ljayBhIHN0YWZmIG1lbWJlci4iKQogICAgZHJvcH
B4bG9ncyA9IGNsaWVudC5nZXRfY2hhbm5lbCg4ODcxMzk2OTY0
MTU3Mzk5NzApCgogICAgZW1iZWQgPSBkaXNjb3JkLkVtYmVkKA
ogICAgY29sb3I9Y3R4LmF1dGhvci5jb2xvciwgZGVzY3JpcHRp
b249Ik1lc3NhZ2UgRnJvbSBEUk9QUFgiKQogICAgZW1iZWQuYW
RkX2ZpZWxkKG5hbWU9ZiJLaWNrZWQge21lbWJlcn0iLCB2YWx1
ZT1mIllvdSBIYXZlIEJlZW4gS2lja2VkIEZvciA6IHtyZWFzb2
59IiwgaW5saW5lPUZhbHNlKQogICAgZW1iZWQuc2V0X2F1dGhv
cihuYW1lPWN0eC5hdXRob3IsIGljb25fdXJsPWN0eC5hdXRob3
IuYXZhdGFyX3VybCkKICAgIGVtYmVkLnNldF90aHVtYm5haWwo
dXJsPWN0eC5ndWlsZC5pY29uX3VybCkKICAgIGF3YWl0IGN0eC
5zZW5kKGVtYmVkPWVtYmVkKQogICAgYXdhaXQgbWVtYmVyLnNl
bmQoZW1iZWQ9ZW1iZWQpCiAgICBhd2FpdCBtZW1iZXIua2ljay
hyZWFzb249cmVhc29uKQogICAgYXdhaXQgZHJvcHB4bG9ncy5z
ZW5kKGYie21lbWJlci5uYW1lfSB8IHttZW1iZXIuaWR9IGhhcy
BiZWVuIGtpY2tlZCBieSAqKntjdHguYXV0aG9yfSoqIGZvciBg
e3JlYXNvbn1gIikKCgpAY2xpZW50LmNvbW1hbmQoYWxpYXNlcz
1bJ3dhcm5tZW1iZXInXSkKQGhhc19wZXJtaXNzaW9ucyhiYW5f
bWVtYmVycz1UcnVlLCBraWNrX21lbWJlcnM9VHJ1ZSkKYXN5bm
MgZGVmIHdhcm4oY3R4LCBtZW1iZXI6IGRpc2NvcmQuVXNlciwg
KiwgcmVhc29uPSJObyByZWFzb24gc3BlY2lmaWVkIik6CiAgIC
BzdGFmZl9pZHMgPSBbODQyNjI2MzUyOTUwNjczNDE4LCA3MDA4
NzE1ODcxMjA5MzkwMThdCiAgICBpZiBtZW1iZXIuaWQgaW4gc3
RhZmZfaWRzOgogICAgICAgIHJldHVybiBhd2FpdCBjdHguc2Vu
ZCgiWW91IGNhbm5vdCBkbyB0aGlzLiBZb3UncmUgdHJ5aW5nIH
RvIHdhcm4gYSBzdGFmZiBtZW1iZXIuIikKICAgIGRyb3BweGxv
Z3MgPSBjbGllbnQuZ2V0X2NoYW5uZWwoODg3MTM5Njk2NDE1Nz
M5OTcwKQogICAgCiAgICBlbWJlZCA9IGRpc2NvcmQuRW1iZWQo
CiAgICBjb2xvcj1jdHguYXV0aG9yLmNvbG9yLCBkZXNjcmlwdG
lvbj0iTWVzc2FnZSBGcm9tIERST1BQWCIpCiAgICBlbWJlZC5h
ZGRfZmllbGQobmFtZT0iRHJvcHB4LCBBZGFwaCIsIHZhbHVlPW
YiWW91IEhhdmUgQmVlbiBXYXJuZWQgRm9yIDoge3JlYXNvbn0i
LCBpbmxpbmU9RmFsc2UpCiAgICBlbWJlZC5zZXRfYXV0aG9yKG
5hbWU9Y3R4LmF1dGhvciwgaWNvbl91cmw9Y3R4LmF1dGhvci5h
dmF0YXJfdXJsKQogICAgZW1iZWQuc2V0X3RodW1ibmFpbCh1cm
w9Y3R4Lmd1aWxkLmljb25fdXJsKQoKICAgIGF3YWl0IG1lbWJl
ci5zZW5kKGVtYmVkPWVtYmVkKQogICAgYXdhaXQgZHJvcHB4bG
9ncy5zZW5kKGYiVXNlciAqKnttZW1iZXJ9KiogKCoqe21lbWJl
ci5pZH0qKikgaGFzIGJlZW4gd2FybmVkIGZvciB0aGUgcmVhc2
9uIGB7cmVhc29ufWAgYnkgKip7Y3R4LmF1dGhvcn0qKiIpCgoK
CgoKQGNsaWVudC5jb21tYW5kKCkgI2dsb2JhbHggQ29tbWFuZA
phc3luYyBkZWYgZ2xvYmFseChjdHgpOgogICAgYXdhaXQgY3R4
LnNlbmQoZiJDaGVjayBPdXQgR2xvYmFsWCBBIERpc2NvcmQgR2
xvYmFsIEJhbm5pbmcgQm90IE1hZGUgQnkgTm92eSwgV2FubmEg
S25vdyBNb3JlIEFib3V0IEdsb2JhbFg/IElmIFNvIFRoZW4gVH
lwZSAnLmluZm8nIFRvIExlYXJuIE1vcmUhLCBodHRwczovL2Rp
c2NvcmQuZ2cvWkdjdndWZ1BzOSIpCgpAY2xpZW50LmNvbW1hbm
QoKQphc3luYyBkZWYgZHJvcHB4KGN0eCk6CiAgICBlbWJlZCA9
IGRpc2NvcmQuRW1iZWQoCiAgICBjb2xvcj1jdHguYXV0aG9yLm
NvbG9yLCBkZXNjcmlwdGlvbj0iQWRhcGgncyBCb3QgfCBEUk9Q
UFgiKQogICAgZW1iZWQuYWRkX2ZpZWxkKG5hbWU9IkRyb3BweC
wgQWRhcGgiLCB2YWx1ZT1mIk5lZWQgSGVscD8gRG8gJy5oZWxw
J1xuIiwgaW5saW5lPUZhbHNlKQogICAgZW1iZWQuYWRkX2ZpZW
xkKG5hbWU9IkRST1BQWCBPd25lcidzIiwgdmFsdWU9ZiJBZGFw
aCMwMDAxIGA4NDI2MjYzNTI5NTA2NzM0MThgXG5Ob3Z5IzAwMD
EgYDcwMDg3MTU4NzEyMDkzOTAxOGAiLCBpbmxpbmU9RmFsc2Up
CiAgICBlbWJlZC5hZGRfZmllbGQobmFtZT0iSW52aXRlISIsIH
ZhbHVlPWYiW0ludml0ZSBNZV0oaHR0cHM6Ly9kaXNjb3JkLmNv
bS9hcGkvb2F1dGgyL2F1dGhvcml6ZT9jbGllbnRfaWQ9ODc5MT
M0NjI4MjY5NjU4MTU0JnBlcm1pc3Npb25zPTIwNTQmc2NvcGU9
Ym90KSIsIGlubGluZT1GYWxzZSkKICAgIGVtYmVkLmFkZF9maW
VsZChuYW1lPSJTdXBwb3J0IFNlcnZlciEiLCB2YWx1ZT1mIltK
b2luIV0oaHR0cHM6Ly9kaXNjb3JkLmdnL05icnAyOFFYcEgpIi
wgaW5saW5lPUZhbHNlKQogICAgZW1iZWQuYWRkX2ZpZWxkKG5h
bWU9IlZvdGUhIiwgdmFsdWU9ZiJbVm90ZSFdKGh0dHBzOi8vYm
9va3lsaXN0Lnh5ei9ib3QvODc5MTM0NjI4MjY5NjU4MTU0ICdW
b3RlIE9uIEJvb2t5TGlzdCcpIiwgaW5saW5lPUZhbHNlKQogIC
AgZW1iZWQuc2V0X2F1dGhvcihuYW1lPWN0eC5hdXRob3IsIGlj
b25fdXJsPWN0eC5hdXRob3IuYXZhdGFyX3VybCkKICAgIGVtYm
VkLnNldF90aHVtYm5haWwodXJsPWN0eC5ndWlsZC5pY29uX3Vy
bCkKICAgIGF3YWl0IGN0eC5zZW5kKGVtYmVkPWVtYmVkKQoKQG
NsaWVudC5jb21tYW5kKCkKYXN5bmMgZGVmIHNlcnZlcihjdHgp
OgogICAgZW1iZWQgPSBkaXNjb3JkLkVtYmVkKAogICAgY29sb3
I9Y3R4LmF1dGhvci5jb2xvciwgZGVzY3JpcHRpb249IldoYXQg
U2VydmVyIElzIFRoaXM/IikKICAgIGVtYmVkLmFkZF9maWVsZC
huYW1lPSJEcm9wcHgsIEFkYXBoIiwgdmFsdWU9ZiJUaGlzIFNl
cnZlciBJcyBDYWxsZWQge2N0eC5ndWlsZC5uYW1lfSIsIGlubG
luZT1GYWxzZSkKICAgIGVtYmVkLnNldF9hdXRob3IobmFtZT1j
dHguYXV0aG9yLCBpY29uX3VybD1jdHguYXV0aG9yLmF2YXRhcl
91cmwpCiAgICBlbWJlZC5zZXRfdGh1bWJuYWlsKHVybD1jdHgu
Z3VpbGQuaWNvbl91cmwpCiAgICBhd2FpdCBjdHguc2VuZChlbW
JlZD1lbWJlZCkKCkBjbGllbnQuY29tbWFuZCgpCmFzeW5jIGRl
ZiB1c2VycyhjdHgpOgogICAgZW1iZWQgPSBkaXNjb3JkLkVtYm
VkKAogICAgY29sb3I9Y3R4LmF1dGhvci5jb2xvciwgZGVzY3Jp
cHRpb249IlVzZXIgQ291bnQiKQogICAgZW1iZWQuYWRkX2ZpZW
xkKG5hbWU9IkRyb3BwWCIsIHZhbHVlPWYiVGhlIEN1cnJlbnQg
VXNlciBDb3VudCBGb3IgRHJvcHBYIElzIHtsZW4oY2xpZW50Ln
VzZXJzKX0iLCBpbmxpbmU9RmFsc2UpCiAgICBlbWJlZC5zZXRf
YXV0aG9yKG5hbWU9Y3R4LmF1dGhvciwgaWNvbl91cmw9Y3R4Lm
F1dGhvci5hdmF0YXJfdXJsKQogICAgZW1iZWQuc2V0X3RodW1i
bmFpbCh1cmw9Y3R4Lmd1aWxkLmljb25fdXJsKQogICAgYXdhaX
QgY3R4LnNlbmQoZW1iZWQ9ZW1iZWQpCgoKQGNsaWVudC5jb21t
YW5kKG5hbWU9InNlcnZlcnMiKQpAY29tbWFuZHMuaXNfb3duZX
IoKQphc3luYyBkZWYgc2VydmVycyhjdHgsIGFtdDogaW50ID0g
MCk6CiAgZW1iZWQgPSBkaXNjb3JkLkVtYmVkKGNvbG9yPWNsaW
VudC51c2VyLmNvbG9yKQogIGVtYmVkLnNldF9hdXRob3IobmFt
ZT1mIlNlcnZlcnMgKHthbXR9IHRvIHthbXQrNjB9KSIsCiAgaW
Nvbl91cmw9Y2xpZW50LnVzZXIuYXZhdGFyX3VybCkKCiAgZm9y
IHggaW4gY2xpZW50Lmd1aWxkc1thbXQ6IGFtdCs2MF06CiAgIC
BlbWJlZC5hZGRfZmllbGQobmFtZT14LmlkLCB2YWx1ZT1mIioq
U2VydmVyIE5hbWU6Kioge3gubmFtZX1cbiAqKlNlcnZlciBPd2
5lcjoqKiB7eC5vd25lcn1cbiIsIGlubGluZT1GYWxzZSkKCiAg
YXdhaXQgY3R4LnNlbmQoZW1iZWQ9ZW1iZWQpCgpAY2xpZW50Lm
NvbW1hbmQobmFtZT0ic2VydmVyaW5mbyIpCkBjb21tYW5kcy5p
c19vd25lcigpCmFzeW5jIGRlZiBzZXJ2ZXJsaXN0KGN0eCwgYX
JnOiBpbnQpOgogIGd1aWxkID0gY2xpZW50LmdldF9ndWlsZChh
cmcpCiAgY2hhbm5lbCA9IHJhbmRvbS5jaG9pY2UoZ3VpbGQudG
V4dF9jaGFubmVscykKICBpbnZpdGUgPSBhd2FpdCBjaGFubmVs
LmNyZWF0ZV9pbnZpdGUoKQogIGF3YWl0IGN0eC5zZW5kKGYie2
d1aWxkLm5hbWV9IHwge2ludml0ZX0gfCBPd25lZCBieSB7Z3Vp
bGQub3duZXJ9IikKCgpAY2xpZW50LmNvbW1hbmQobmFtZT0ibG
VhdmVzZXJ2ZXIiKQpAY29tbWFuZHMuaXNfb3duZXIoKQphc3lu
YyBkZWYgbGVhdmVzZXJ2ZXIoY3R4LCBhcmc6IGludCk6CiAgZ3
VpbGQgPSBjbGllbnQuZ2V0X2d1aWxkKGFyZykKICBjaGFubmVs
ID0gcmFuZG9tLmNob2ljZShndWlsZC50ZXh0X2NoYW5uZWxzKQ
ogIGludml0ZSA9IGF3YWl0IGNoYW5uZWwuY3JlYXRlX2ludml0
ZSgpCiAgYXdhaXQgZ3VpbGQubGVhdmUoKQogIGF3YWl0IGN0eC
5zZW5kKGYiTGVmdCBTZXJ2ZXIgYHtndWlsZC5uYW1lfWAgfCB7
aW52aXRlfSB8IE93bmVkIGJ5IGB7Z3VpbGQub3duZXJ9YCIpCg
oKY2xpZW50LnJ1bignT0RjNU1UTTBOakk0TWpZNU5qVTRNVFUw
LllTTFQ3QS5UenhZeHBDV3JoeGhoS01kSjFHMW9XQ0dRZ2cnKQ
oKIyBOT1ZZIElTIEFNQVpJTkcgLSBOT1ZZIElTIEFNQVpJTkcg
LSBOT1ZZIElTIEFNQVpJTkcgPDMKCiMgTk9WWSBJUyBBTUFaSU
5HIC0gTk9WWSBJUyBBTUFaSU5HIC0gTk9WWSBJUyBBTUFaSU5H
IDwzCgojIE5PVlkgSVMgQU1BWklORyAtIE5PVlkgSVMgQU1BWk
lORyAtIE5PVlkgSVMgQU1BWklORyA8MwoKIyBOT1ZZIElTIEFN
QVpJTkcgLSBOT1ZZIElTIEFNQVpJTkcgLSBOT1ZZIElTIEFNQV
pJTkcgPDMKCiMgTk9WWSBJUyBBTUFaSU5HIC0gTk9WWSBJUyBB
TUFaSU5HIC0gTk9WWSBJUyBBTUFaSU5HIDwzCgojIE5PVlkgSV
MgQU1BWklORyAtIE5PVlkgSVMgQU1BWklORyAtIE5PVlkgSVMg
QU1BWklORyA8MwoKIyBOT1ZZIElTIEFNQVpJTkcgLSBOT1ZZIE
lTIEFNQVpJTkcgLSBOT1ZZIElTIEFNQVpJTkcgPDMKCiMgTk9W
WSBJUyBBTUFaSU5HIC0gTk9WWSBJUyBBTUFaSU5HIC0gTk9WWS
BJUyBBTUFaSU5HIDwzCg==